@using System.Text.Json
@using Radzen
@using Radzen.Blazor
@using ZauberCMS.Components.Editors.Models
@using ZauberCMS.Core.Extensions
@implements ZauberCMS.Core.Content.Interfaces.IContentPropertySettings

<RadzenStack Orientation="Orientation.Vertical" JustifyContent="JustifyContent.Left" AlignItems="AlignItems.Center" Gap="1">
    <RadzenNumeric @bind-Value="@Settings.MaxLength" Placeholder="Max Length Allowed" Style="width: 100%;" InputAttributes="@(new Dictionary<string,object>{ { "aria-label", "enter max length" }})" />    
</RadzenStack>

<RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.Right" AlignItems="AlignItems.Center" class="rz-mt-3">
    <RadzenButton ButtonType="ButtonType.Submit" ButtonStyle="ButtonStyle.Success" Icon="save" Text="Save" Click="Save"/>
</RadzenStack>

@code {
    [Parameter] public string? SettingsModel { get; set; }
    [Parameter] public EventCallback<string> ValueChanged { get; set; }
    private TextContentSettingsModel Settings { get; set; } = new();
    
    protected override void OnInitialized()
    {
        if (!SettingsModel.IsNullOrWhiteSpace())
        {
            Settings = JsonSerializer.Deserialize<TextContentSettingsModel>(SettingsModel) ?? new TextContentSettingsModel();
        }
    }
    
    private async Task Save()
    {
        var updatedSettingsModel = JsonSerializer.Serialize(Settings);
        await ValueChanged.InvokeAsync(updatedSettingsModel);
    }
}